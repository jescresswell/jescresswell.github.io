---
title: "A Geometric Explanation of the Likelihood OOD Detection Paradox"
collection: publications
permalink: /publication/2024-07-ood-lid
excerpt: 
date: 2024-07-21
authors: 'Hamidreza Kamkari, Brendan Leigh Ross, <b>Jesse C. Cresswell</b>, Anthony L. Caterini, Rahul G. Krishnan, Gabriel Loaiza-Ganem'
note:
venueshort: 'ICML 2024'
venue: 'International Conference on Machine Learning 2024'
paperurl: 'https://openreview.net/forum?id=EVMzCKLpdD'
pdf: 'https://arxiv.org/pdf/2403.18910.pdf'
codeurl: 'https://github.com/layer6ai-labs/dgm_ood_detection'
videourl:
slidesurl:
citation: 'Hamidreza Kamkari, Brendan Leigh Ross, Jesse C. Cresswell, Anthony L. Caterini, Rahul G. Krishnan, Gabriel Loaiza-Ganem. A Geometric Explanation of the Likelihood OOD Detection Paradox. International Conference on Machine Learning 2024'
---
Likelihood-based deep generative models (DGMs) commonly exhibit a puzzling behaviour: when trained on a relatively complex dataset, they assign higher likelihood values to out-of-distribution (OOD) data from simpler sources. Adding to the mystery, OOD samples are never generated by these DGMs despite having higher likelihoods. This two-pronged paradox has yet to be conclusively explained, making likelihood-based OOD detection unreliable. Our primary observation is that high-likelihood regions will not be generated if they contain minimal probability mass. We demonstrate how this seeming contradiction of large densities yet low probability mass can occur around data confined to low-dimensional manifolds. We also show that this scenario can be identified through local intrinsic dimension (LID) estimation, and propose a method for OOD detection which pairs the likelihoods and LID estimates obtained from a pre-trained DGM.